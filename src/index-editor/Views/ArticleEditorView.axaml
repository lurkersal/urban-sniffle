<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:IndexEditor.Views"
             x:Class="IndexEditor.Views.ArticleEditorView">
    <UserControl.Resources>
        <local:CategoryToBrushConverter x:Key="CategoryToBrush"/>
        <local:CategoryDisplayModeMatchesConverter x:Key="CategoryModeMatches" />
        <local:ShowPhotographerCategoryConverter x:Key="ShowPhotographer" />
    </UserControl.Resources>
    <Grid>
        <StackPanel Margin="16">
            <!-- Single Article Card for Editing -->
            <Border Background="{Binding SelectedArticle.Category, Converter={StaticResource CategoryToBrush}}" CornerRadius="4" Padding="16" Margin="0,0,0,16">
                <StackPanel Orientation="Vertical" Spacing="6">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Category:" FontWeight="Bold" Width="120"/>
                        <ComboBox SelectedItem="{Binding SelectedCategory, Mode=TwoWay}"
                                  ItemsSource="{Binding DataContext.Categories, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                  Width="240"/>
                        <TextBlock Text="Loading categories..." Foreground="Gray" FontSize="12" Margin="12,0,0,0"
                                   IsVisible="{Binding DataContext.IsLoadingCategories, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" IsVisible="{Binding SelectedArticle.Category, Converter={StaticResource CategoryModeMatches}, ConverterParameter='1,2,3'}">
                        <TextBlock Text="Title:" FontWeight="Bold" Width="120"/>
                        <TextBox Text="{Binding SelectedArticle.Title, Mode=TwoWay}" Width="240"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" IsVisible="{Binding SelectedArticle.Category, Converter={StaticResource CategoryModeMatches}, ConverterParameter='2'}">
                        <TextBlock Text="Model:" FontWeight="Bold" Width="120"/>
                        <TextBox Text="{Binding SelectedArticle.ModelNames[0], Mode=TwoWay}" Width="240"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" IsVisible="{Binding SelectedArticle.Category, Converter={StaticResource CategoryModeMatches}, ConverterParameter='2'}">
                        <TextBlock Text="Age:" FontWeight="Bold" Width="120"/>
                        <TextBox Text="{Binding SelectedArticle.Ages[0], Mode=TwoWay}" Width="120"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" IsVisible="{Binding SelectedArticle.Category, Converter={StaticResource CategoryModeMatches}, ConverterParameter='2'}">
                        <TextBlock Text="Measurements:" FontWeight="Bold" Width="120"/>
                        <TextBox Width="240">
                            <TextBox.Text>
                                <Binding Path="SelectedArticle.Measurements0" Mode="TwoWay" UpdateSourceTrigger="LostFocus" />
                            </TextBox.Text>
                        </TextBox>
                    </StackPanel>
                    <TextBlock Text="{Binding SelectedArticle.MeasurementsErrorMessage}" Foreground="Red" FontSize="12" Margin="124,2,0,0" IsVisible="{Binding SelectedArticle.HasMeasurementsError}" />
                    <TextBlock Text="Format: bust(+cup)-waist-hip â€” e.g. '36B-28-38' (separator must be '-')" Foreground="Gray" FontSize="11" Margin="124,2,0,0" IsVisible="{Binding SelectedArticle.HasMeasurementsError}" />

                    <StackPanel Orientation="Horizontal" IsVisible="{Binding SelectedArticle.Category, Converter={StaticResource ShowPhotographer}}">
                        <TextBlock Text="Photographer:" FontWeight="Bold" Width="120"/>
                        <TextBox Text="{Binding SelectedArticle.Photographers[0], Mode=TwoWay}" Width="240"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Pages:" FontWeight="Bold" Width="120"/>
                        <TextBox Text="{Binding SelectedArticle.PagesText, Mode=TwoWay}" Width="240"/>
                    </StackPanel>
                </StackPanel>
            </Border>
            <!-- Page Segments and Notes removed from this view -->
            </StackPanel>
            <!-- Overlay for SegmentEditorPopover -->
            <!-- <Border Name="SegmentEditorOverlay" Background="#80000000" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" ZIndex="100" IsVisible="False">
                <views:SegmentEditorPopover HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border> -->
        </Grid>
    </UserControl>
