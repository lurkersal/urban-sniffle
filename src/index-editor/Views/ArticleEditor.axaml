<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:IndexEditor.Views"
             x:Class="IndexEditor.Views.ArticleEditor">
    <UserControl.Resources>
        <local:ArticleCategoryToColorConverter x:Key="ArticleCategoryToColorConverter" />
        <local:ArticleFieldFriendlyTextConverter x:Key="ArticleFieldFriendlyTextConverter" />
        <local:FieldErrorToBrushConverter x:Key="FieldErrorToBrushConverter" />
        <local:CategoryDisplayModeMatchesConverter x:Key="CategoryModeMatches" />
        <local:FieldLabelConverter x:Key="FieldLabelConverter" />
        <local:ShowPhotographerCategoryConverter x:Key="ShowPhotographer" />
    </UserControl.Resources>
    <StackPanel Margin="8">
        <TextBlock Text="Article Editor" FontWeight="Bold" FontSize="16" Margin="8,8,8,4"/>
        <!-- Show editor only when an article is selected -->
        <ContentControl Content="{Binding SelectedArticle}">
            <ContentControl.ContentTemplate>
                <DataTemplate>
                    <Border Background="{Binding Category, Converter={StaticResource ArticleCategoryToColorConverter}}" CornerRadius="6" Padding="12" Margin="0,8">
                        <StackPanel Orientation="Vertical" Spacing="4">
                            <!-- Category row -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                <TextBlock Text="Category:" FontWeight="Bold" Width="120" VerticalAlignment="Center"/>
                                <StackPanel Orientation="Vertical">
                                    <ComboBox SelectedItem="{Binding DataContext.SelectedCategory, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay}"
                                              ItemsSource="{Binding DataContext.Categories, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                              Width="260" HorizontalContentAlignment="Left"
                                              BorderBrush="{Binding HasCategoryError, Converter={StaticResource FieldErrorToBrushConverter}}"/>
                                    <TextBlock Text="Loading categories..." Foreground="Gray" FontSize="12" Margin="4,4,0,0"
                                               IsVisible="{Binding DataContext.IsLoadingCategories, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                                    <TextBlock Text="{Binding CategoryDisplay}" Foreground="Red" FontSize="12" Margin="4,2,0,0" IsVisible="{Binding HasCategoryError}" />
                                </StackPanel>
                            </StackPanel>

                            <!-- Title row -->
                            <StackPanel Orientation="Horizontal" Margin="0,4" IsVisible="{Binding Category, Converter={StaticResource CategoryModeMatches}, ConverterParameter=&quot;1,2,3&quot;}">
                                <TextBlock Text="Title:" FontWeight="Bold" Width="120" VerticalAlignment="Center"/>
                                <TextBox Text="{Binding Title, Mode=TwoWay}" Width="360" />
                            </StackPanel>

                            <!-- Model/Cover rows -->
                            <StackPanel Orientation="Horizontal" Margin="0,4" IsVisible="{Binding Category, Converter={StaticResource CategoryModeMatches}, ConverterParameter=&quot;2&quot;}">
                                <TextBlock Text="Model:" FontWeight="Bold" Width="120" VerticalAlignment="Center"/>
                                <TextBox Text="{Binding ModelName0, Mode=TwoWay}" Width="360" />
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4" IsVisible="{Binding Category, Converter={StaticResource CategoryModeMatches}, ConverterParameter=&quot;2&quot;}">
                                <TextBlock Text="Age:" FontWeight="Bold" Width="120" VerticalAlignment="Center"/>
                                <TextBox Text="{Binding Age0, Mode=TwoWay}" Width="120" />
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4" IsVisible="{Binding Category, Converter={StaticResource CategoryModeMatches}, ConverterParameter=&quot;2&quot;}">
                                <TextBlock Text="Measurements:" FontWeight="Bold" Width="120" VerticalAlignment="Center"/>
                                <TextBox Text="{Binding Measurements0, Mode=TwoWay}" Width="240" />
                            </StackPanel>
                            <!-- Measurements validation message -->
                            <TextBlock Text="{Binding MeasurementsErrorMessage}" Foreground="Red" FontSize="12" Margin="124,2,0,0" IsVisible="{Binding HasMeasurementsError}" />
                            <TextBlock Text="Format: bust(+cup)-waist-hip â€” e.g. '36B-28-38' (separator must be '-')" Foreground="Gray" FontSize="11" Margin="124,2,0,0" IsVisible="{Binding HasMeasurementsError}" />

                            <!-- Photographer row -->
                            <StackPanel Orientation="Horizontal" Margin="0,4" IsVisible="{Binding Category, Converter={StaticResource ShowPhotographer}}">
                                <TextBlock Text="{Binding Category, Converter={StaticResource FieldLabelConverter}, ConverterParameter=Photographer}" FontWeight="Bold" Width="120" VerticalAlignment="Center"/>
                                <TextBox Text="{Binding Photographer0, Mode=TwoWay}" Width="360" />
                            </StackPanel>

                            <!-- Pages row -->
                            <StackPanel Orientation="Horizontal" Margin="0,4">
                                <TextBlock Text="Pages:" FontWeight="Bold" Width="120" VerticalAlignment="Center"/>
                                <TextBox Text="{Binding PagesText, Mode=TwoWay}" Width="240" BorderBrush="{Binding HasPagesError, Converter={StaticResource FieldErrorToBrushConverter}}" />
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </ContentControl.ContentTemplate>
        </ContentControl>

        <!-- Page Segments and Notes removed - simplified editor -->
    </StackPanel>
</UserControl>
